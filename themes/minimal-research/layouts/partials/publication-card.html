<article id="{{ .File.BaseFileName }}" class="publication-card bg-gray-50 dark:bg-gray-800/50 rounded-lg p-6 mb-6 border border-gray-200 dark:border-gray-700 hover:shadow-lg transition-shadow duration-300" x-data="{ showAbstract: false }">
  <!-- Publication Title -->
  <h3 class="text-xl font-semibold text-gray-900 dark:text-gray-100 mb-3 leading-tight">
    {{ .Title }}
  </h3>
  
  <!-- APA Citation -->
  <div class="apa-citation text-gray-700 dark:text-gray-300 mb-4 leading-relaxed">
    <!-- Authors -->
    <span class="authors">
      {{ if reflect.IsSlice .Params.authors }}
        {{ range $index, $author := .Params.authors }}
          {{- if $index }}, {{ end }}
          {{- $author -}}
        {{- end }}
      {{ else }}
        {{ .Params.authors }}
      {{ end }}
    </span>
    
    <!-- Year -->
    ({{ .Params.year }}{{ with .Params.month }}, {{ . }}{{ end }}).
    
    <!-- Title (already shown above, so we skip it in citation) -->
    
    <!-- Journal/Source -->
    <em>{{ .Params.journal }}</em>{{ with .Params.volume }}, {{ . }}{{ end }}{{ with .Params.issue }}({{ . }}){{ end }}{{ with .Params.pages }}, {{ . }}{{ end }}.
  </div>
  
  <!-- Metadata Badges -->
  <div class="metadata-badges flex flex-wrap gap-2 mb-4">
    <!-- Publication Type Badge -->
    {{ $pubType := .Params.publication_type | default "article" }}
    {{ $typeColors := dict "journal" "bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200" "preprint" "bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200" "conference" "bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200" "book" "bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200" }}
    <span class="badge px-3 py-1 rounded-full text-xs font-medium {{ index $typeColors $pubType | default "bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-200" }}">
      {{ $pubType | title }}
    </span>
    
    <!-- Source Badge if available -->
    {{ with .Params.source }}
      <span class="badge px-3 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-300">
        Source: {{ . }}
      </span>
    {{ end }}
    
    <!-- DOI Badge -->
    {{ with .Params.doi }}
      <a href="https://doi.org/{{ . }}" target="_blank" rel="noopener" class="badge px-3 py-1 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800 dark:bg-indigo-900 dark:text-indigo-200 hover:bg-indigo-200 dark:hover:bg-indigo-800 transition-colors">
        <svg class="inline-block w-3 h-3 mr-1" fill="currentColor" viewBox="0 0 20 20">
          <path d="M11 3a1 1 0 100 2h2.586l-6.293 6.293a1 1 0 101.414 1.414L15 6.414V9a1 1 0 102 0V4a1 1 0 00-1-1h-5z"></path>
          <path d="M5 5a2 2 0 00-2 2v8a2 2 0 002 2h8a2 2 0 002-2v-3a1 1 0 10-2 0v3H5V7h3a1 1 0 000-2H5z"></path>
        </svg>
        DOI
      </a>
    {{ end }}
  </div>
  
  <!-- Abstract (Expandable) -->
  {{ with .Params.abstract }}
    <div class="abstract-section">
      <button @click="showAbstract = !showAbstract" class="text-sm text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 font-medium flex items-center gap-1">
        <svg class="w-4 h-4 transform transition-transform" :class="{'rotate-90': showAbstract}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
        </svg>
        Show abstract
      </button>
      <div x-show="showAbstract" x-transition class="mt-3 p-4 bg-gray-100 dark:bg-gray-700/50 rounded-md">
        <div class="text-sm text-gray-700 dark:text-gray-300 leading-relaxed">{{ . | safeHTML }}</div>
      </div>
    </div>
  {{ end }}
  
  <!-- Keywords -->
  {{ with .Params.keywords }}
    <div class="keywords mt-4 flex flex-wrap gap-2">
      {{ range . }}
        <span class="text-xs px-2 py-1 bg-gray-200 dark:bg-gray-700 text-gray-600 dark:text-gray-400 rounded">{{ . }}</span>
      {{ end }}
    </div>
  {{ end }}
</article>